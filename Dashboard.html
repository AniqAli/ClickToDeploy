<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Example</title>
  <link rel="stylesheet" href="./assets/css/signinSignupStyle.css">

</head>

<body style="background-color: #fff !important;">
  <!-- <p>dashboard</p> -->
  <input type="checkbox" id="check">
  <!--header area start-->
  <header>
    <label for="check">
      <i class="fas fa-bars" id="sidebar_btn"></i>
    </label>
    <div class="left_area">
      <h3>Click To<span> Deploy</span></h3>
    </div>
    <div class="right_area">
      <!-- <a href="./signin.html" class="logout_btn">Logout</a> -->
      <button type="submit" class="logout_btn" onclick="logoutFunc()">Logout</button>
    </div>
  </header>
  <!--header area end-->
  <!--mobile navigation bar start-->
  <!-- <div class="mobile_nav">
    <div class="nav_bar">
      <img src="1.png" class="mobile_profile_image" alt="">
      <i class="fa fa-bars nav_btn"></i>
    </div>
    <div class="mobile_nav_items">
      <a href="#"><span>Dashboard</span></a>
      <a href="#"><span>Settings</span></a>
    </div>
  </div> -->
  <!--mobile navigation bar end-->
  <!--sidebar start-->
  <div class="sidebar">
    <!-- <div class="profile_info">
      <img src="https://i.imgur.com/iQpdHb2.jpg" class="profile_image" alt="">
      <h4>Williamson</h4>
    </div> -->
    <a href="#" onclick="showDashboardBox()"><span>Dashboard</span></a>
    <a href="#" onclick="showDeployBox()"><span>Deploy</span></a>
    <a href="#" onclick="showSettingBox()"><span>Settings</span></a>
  </div>
  <!--sidebar end-->

  <div class="dashboard-body">
    <!-- <div class="loading-main">
      <div class="loading-box">
        <img src="./assets/img/loading-anim.gif" alt="deploy">
        <h5>
          Deploying... Please Wait!
        </h5>
      </div>
    </div> -->

    <!-- dashboard content -->
    <div class="dash-cont" id="dash-cont">
      <div class="dash-header">
        <h3>
          Dashboard
        </h3>
      </div>
      <div class="dash-cards-row">
        <div class="dash-card">
          <div class="card-body">
            <div class="card-inner-box">
              <p>20</p>
              <img src="./assets/img/web-deploy-icon.png" alt=""
                style="width: 100%; max-width: 40px; height: 100%; max-height: 40px; margin-top: -3px;">
            </div>
            <p>Websites Deployed</p>
          </div>
        </div>
        <div class="dash-card">
          <div class="card-body">
            <div class="card-inner-box">
              <p>18</p>
              <img src="./assets/img/active-users-icon.png" alt=""
                style="width: 100%; max-width: 40px; height: 100%; max-height: 40px; margin-top: -3px;">
            </div>
            <p>Active Users</p>
          </div>
        </div>
        <div class="dash-card">
          <div class="card-body">
            <div class="card-inner-box">
              <p>25</p>
              <img src="./assets/img/world-clients-icon.png" alt=""
                style="width: 100%; max-width: 40px; height: 100%; max-height: 40px; margin-top: -3px;">
            </div>
            <p>World Wide Clients</p>
          </div>
        </div>
        <div class="dash-card">
          <div class="card-body">
            <div class="card-inner-box">
              <p>20</p>
              <img src="./assets/img/total-deploys-icons.png" alt=""
                style="width: 100%; max-width: 40px; height: 100%; max-height: 40px; margin-top: -3px;">
            </div>
            <p>Total Deploys</p>
          </div>
        </div>
      </div>
    </div>
    <!-- deploy content -->
    <div class="depl-cont" id="depl-cont">
      <!-- <div class="loader-main">
        <div class="spin"></div>
      </div> -->

      <div class="deploy-header">
        <h3>
          Deploy
        </h3>
      </div>
      <div class="deploy-row">
        <div class="deploy-col1">
          <div class="deploy-form">
            <form class="register-form" id="newProjectForm" onsubmit="createProjectForm(event)">
              <input type="text" placeholder="Repository Url" id="repoUrl" required />
              <input type="text" placeholder="Website Name Should be .com in the end" id="webName" required />
              <input type="text" placeholder="Workspace" id="workspace" required />
              <input type="number" placeholder="Exposed Port" id="exposedPort" required />
              <button type="submit">
                Click To Deploy
              </button>
            </form>
          </div>
        </div>
        <div class="deploy-col2">
          <img src="./assets/img/deploy-anim.gif" alt="deploy" class="deploy-anim">
        </div>
      </div>
    </div>
    <!-- settings content -->
    <div class="sett-cont" id="sett-cont">
      <div class="settings-header">
        <h3>
          Change Settings
        </h3>
      </div>
      <div class="settings-row">
        <form class="register-form" id="newProjectForm" onsubmit="updateProfBtn(event)">
          <div class="settings-col1">
            <p>Name:</p>
            <input type="text" placeholder="Name" id="settingName" />
          </div>
          <div class="settings-col2">
            <p>Email:</p>
            <input type="email" placeholder="Email Address" id="settingEmail" />
          </div>
          <!-- <div class="settings-col3">
            <p>Password:</p>
            <input type="password" placeholder="Password" id="settingPass" />
          </div> -->
          <!-- <button class="updateProfBtn" type="submit">Update Profile</button> -->
        </form>
        <!-- <div class="settings-col2">
          <img src="./assets/img/about.jpg" alt="profile image">
          <button>Change Profile Picture</button>
        </div> -->
      </div>
    </div>
  </div>

  <!-- Dashboard content -->
  <!-- <div class="dashboard-content">
    <div class="card">
      <p>
        Dashboard
      </p>
    </div>
  </div> -->

  <!-- Deploy content -->
  <div class="deploy-content">
    <div class="card">
      <p>
        Deploy
      </p>
    </div>
  </div>

  <!-- Settings content -->
  <div class="settings-content">
    <div class="card">
      <p>
        Settings
      </p>
    </div>
  </div>

  <!-- <script type="text/javascript">
    const dash_content = document.getElementsByClassName("dashboard-content");
    const deploy_content = document.getElementsByClassName("deploy-content");
    // const settings_content = document.getElementsByClassName("settings-content");

    // function clickFunc() {
    //   document.getElementsByClassName('dash-cont').style.display = 'none'
    // }

    if (document.getElementsByClassName("dashboard-content").style.display == 'none') {
      document.getElementsByClassName("deploy-content").style.display == 'block';
    }
    else {
      document.getElementsByClassName("dashboard-content").style.display == 'block';
    }
    // const deploy_btn = document.getElementsByClassName("deploy-btn");

    // deploy_btn.addEventListener("click", function () {
    //   // hide element: element.hidden = true;
    //   // show element: element.hidden = false;
    //   // dash_content.hidden = true;
                
    // });
  </script> -->

  <script src="./assets/js/main.js"></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
  <script src="./script.js"></script>

  <script>

    var userToken = localStorage.getItem("userToken");
    console.log("user token", userToken);

    if (!userToken) {
      alert("unauthorized user")
      window.location.assign("./signin.html")
    }
    else {
      console.log("registered user");

      function createProjectForm(e) {
        e.preventDefault();
        // console.log("e =>", e.target.children);
        var repoUrl = e.target.children[0].value;
        var webName = e.target.children[1].value;
        var workspace = e.target.children[2].value;
        var exposedPort = e.target.children[3].value;
        // var spin = document.getElementsByClassName('loader-main')
        // spin.style.display = 'block'
        // <img src="./assets/img/loading-anim.gif" alt="deploy" />
        fetch("http://52.139.169.174:4000/api/user/create", {
          method: "POST",
          body: JSON.stringify({
            repoURL: repoUrl,
            siteName: webName,
            workspace: workspace,
            exposedPort: exposedPort,
            // accessToken: userToken
          }),
          headers: {
            "Content-type": "application/json",
            "Authorization": `Bearer ${userToken}`
          }
        })
          .then(res => {
            console.log("response", res);
            // spin.style.display = 'none'
            if (res.statusText === "OK") {
              console.log("success");
              alert('Website Successfully Deployed...!')
              const inputs = document.querySelectorAll('#repoUrl, #webName, #workspace, #exposedPort');
              inputs.forEach(input => {
                input.value = '';
              });
              // window.location.reload();
            }
            else if (res.statusText === "Unauthorized") {
              alert(res.statusText + " " + "User!")
            }
            else {
              alert("Something went wrong. Check logs for more details!")
            }
            return res.json()
          })
          .then(data => {
            console.log("deployed data", data);
          })
          .catch(err => console.log(err))
      }

      fetch("http://52.139.169.174:4000/api/user", {
        method: "GET",
        headers: {
          "Content-type": "application/json",
          "Authorization": `Bearer ${userToken}`
        }
      })
        .then(res => {
          console.log("response", res);
          if (res.statusText === "OK") {
            console.log("success");
          }
          else if (res.statusText === "Unauthorized") {
            alert(res.statusText + " " + "User!")
          }
          else {
            alert("Something went wrong. Check logs for more details!")
          }
          return res.json()
        })
        .then(data => {
          console.log("data=>", data);
          document.getElementById('settingName').value = data.data.name;
          document.getElementById('settingEmail').value = data.data.email;
          // console.log(editName);
        })
        .catch(err => console.log(err))

      function updateProfBtn(e) {
        e.preventDefault();
        // console.log("e =>", e.target.children[2].children[1].value);
        // var editName = e.target.children[0].children[1].value;
        // var editPass = e.target.children[1].children[1].value;
        // var editEmail = e.target.children[2].children[1].value;
        // console.log(editName + " " + editPass + " " + editEmail);

      }
    }

    function logoutFunc() {
      console.log("logout clicked");
      // localStorage.removeItem("userToken")
      window.location.assign("./signin.html")
    }
  </script>
</body>

</html>